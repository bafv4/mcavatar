{"version":3,"sources":["../src/react/MinecraftAvatar.tsx","../src/shared/constants.ts","../src/react/MinecraftFullBody.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, memo, useCallback } from 'react';\nimport type { MinecraftAvatarProps } from '../shared/types';\nimport { STEVE_UUID } from '../shared/constants';\n\nconst MinecraftAvatarComponent = ({\n  uuid,\n  mcid,\n  size = 64,\n  className = '',\n  priority = false,\n  apiEndpoint = '/api/avatar',\n}: MinecraftAvatarProps) => {\n  const [imgError, setImgError] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n\n  // Construct API URL\n  const imageUrl = `${apiEndpoint}?uuid=${uuid}&size=${size}`;\n  const fallbackUrl = `${apiEndpoint}?uuid=${STEVE_UUID}&size=${size}`;\n\n  // Reset state when UUID changes\n  useEffect(() => {\n    setImgError(false);\n    setIsLoading(true);\n  }, [uuid]);\n\n  const handleLoad = useCallback(() => {\n    setIsLoading(false);\n  }, []);\n\n  const handleError = useCallback(() => {\n    setImgError(true);\n    setIsLoading(false);\n  }, []);\n\n  return (\n    <div\n      className={className}\n      style={{\n        width: size,\n        height: size,\n        position: 'relative',\n      }}\n    >\n      <img\n        src={imgError ? fallbackUrl : imageUrl}\n        alt={mcid ? `${mcid} のスキン` : 'Minecraft avatar'}\n        width={size}\n        height={size}\n        style={{\n          imageRendering: 'pixelated',\n          display: isLoading ? 'none' : 'block',\n          width: size,\n          height: size,\n        }}\n        onLoad={handleLoad}\n        onError={handleError}\n        loading={priority ? 'eager' : 'lazy'}\n        decoding=\"async\"\n      />\n      {isLoading && (\n        <div\n          style={{\n            width: size,\n            height: size,\n            backgroundColor: '#3c3c3c',\n            position: 'absolute',\n            top: 0,\n            left: 0,\n          }}\n        />\n      )}\n    </div>\n  );\n};\n\n/**\n * Minecraft Avatar Component\n *\n * Displays a player's Minecraft avatar by fetching from the API endpoint.\n *\n * @example\n * ```tsx\n * import { MinecraftAvatar } from '@bafv4/mcavatar/react';\n *\n * <MinecraftAvatar uuid={player.uuid} mcid={player.mcid} size={64} />\n * ```\n */\nexport const MinecraftAvatar = memo(MinecraftAvatarComponent);\n","/**\n * Minecraft Avatar Constants\n */\n\nimport type {\n  AvatarOptions,\n  SkinRegion,\n  FullBodyOptions,\n  BodyPartLayerRegions,\n  ArmRegions,\n  ViewConfig,\n  Vector3,\n} from './types';\n\n/**\n * Steve's UUID for fallback\n */\nexport const STEVE_UUID = '8667ba71b85a4004af54457a9734eed7';\n\n/**\n * Mojang API endpoints\n */\nexport const MOJANG_API = {\n  SESSION_SERVER: 'https://sessionserver.mojang.com/session/minecraft/profile',\n} as const;\n\n/**\n * Skin texture dimensions\n */\nexport const SKIN_DIMENSIONS = {\n  LEGACY: { width: 64, height: 32 },\n  MODERN: { width: 64, height: 64 },\n} as const;\n\n/**\n * Head region coordinates (8x8 pixels)\n */\nexport const HEAD_REGIONS: {\n  BASE: SkinRegion;\n  OVERLAY: SkinRegion;\n} = {\n  /** Base head layer */\n  BASE: { x: 8, y: 8, width: 8, height: 8 },\n  /** Overlay/hat layer (modern skins only) */\n  OVERLAY: { x: 40, y: 8, width: 8, height: 8 },\n};\n\n/**\n * Default avatar options\n */\nexport const DEFAULT_OPTIONS: Required<AvatarOptions> = {\n  size: 64,\n  includeOverlay: true,\n  fallbackUuid: STEVE_UUID,\n};\n\n// ============================================================\n// 3D Full Body Constants\n// ============================================================\n\n/**\n * Body part skin regions for 64x64 modern skins\n * Each body part has base and overlay layers\n * Each layer has 6 faces: front, back, left, right, top, bottom\n */\nexport const BODY_REGIONS = {\n  HEAD: {\n    BASE: {\n      right: { x: 0, y: 8, width: 8, height: 8 },\n      front: { x: 8, y: 8, width: 8, height: 8 },\n      left: { x: 16, y: 8, width: 8, height: 8 },\n      back: { x: 24, y: 8, width: 8, height: 8 },\n      top: { x: 8, y: 0, width: 8, height: 8 },\n      bottom: { x: 16, y: 0, width: 8, height: 8 },\n    },\n    OVERLAY: {\n      right: { x: 32, y: 8, width: 8, height: 8 },\n      front: { x: 40, y: 8, width: 8, height: 8 },\n      left: { x: 48, y: 8, width: 8, height: 8 },\n      back: { x: 56, y: 8, width: 8, height: 8 },\n      top: { x: 40, y: 0, width: 8, height: 8 },\n      bottom: { x: 48, y: 0, width: 8, height: 8 },\n    },\n  } as BodyPartLayerRegions,\n\n  TORSO: {\n    BASE: {\n      right: { x: 16, y: 20, width: 4, height: 12 },\n      front: { x: 20, y: 20, width: 8, height: 12 },\n      left: { x: 28, y: 20, width: 4, height: 12 },\n      back: { x: 32, y: 20, width: 8, height: 12 },\n      top: { x: 20, y: 16, width: 8, height: 4 },\n      bottom: { x: 28, y: 16, width: 8, height: 4 },\n    },\n    OVERLAY: {\n      right: { x: 16, y: 36, width: 4, height: 12 },\n      front: { x: 20, y: 36, width: 8, height: 12 },\n      left: { x: 28, y: 36, width: 4, height: 12 },\n      back: { x: 32, y: 36, width: 8, height: 12 },\n      top: { x: 20, y: 32, width: 8, height: 4 },\n      bottom: { x: 28, y: 32, width: 8, height: 4 },\n    },\n  } as BodyPartLayerRegions,\n\n  RIGHT_ARM: {\n    CLASSIC: {\n      BASE: {\n        right: { x: 40, y: 20, width: 4, height: 12 },\n        front: { x: 44, y: 20, width: 4, height: 12 },\n        left: { x: 48, y: 20, width: 4, height: 12 },\n        back: { x: 52, y: 20, width: 4, height: 12 },\n        top: { x: 44, y: 16, width: 4, height: 4 },\n        bottom: { x: 48, y: 16, width: 4, height: 4 },\n      },\n      OVERLAY: {\n        right: { x: 40, y: 36, width: 4, height: 12 },\n        front: { x: 44, y: 36, width: 4, height: 12 },\n        left: { x: 48, y: 36, width: 4, height: 12 },\n        back: { x: 52, y: 36, width: 4, height: 12 },\n        top: { x: 44, y: 32, width: 4, height: 4 },\n        bottom: { x: 48, y: 32, width: 4, height: 4 },\n      },\n    },\n    SLIM: {\n      BASE: {\n        right: { x: 40, y: 20, width: 4, height: 12 },\n        front: { x: 44, y: 20, width: 3, height: 12 },\n        left: { x: 47, y: 20, width: 4, height: 12 },\n        back: { x: 51, y: 20, width: 3, height: 12 },\n        top: { x: 44, y: 16, width: 3, height: 4 },\n        bottom: { x: 47, y: 16, width: 3, height: 4 },\n      },\n      OVERLAY: {\n        right: { x: 40, y: 36, width: 4, height: 12 },\n        front: { x: 44, y: 36, width: 3, height: 12 },\n        left: { x: 47, y: 36, width: 4, height: 12 },\n        back: { x: 51, y: 36, width: 3, height: 12 },\n        top: { x: 44, y: 32, width: 3, height: 4 },\n        bottom: { x: 47, y: 32, width: 3, height: 4 },\n      },\n    },\n  } as ArmRegions,\n\n  LEFT_ARM: {\n    CLASSIC: {\n      BASE: {\n        right: { x: 32, y: 52, width: 4, height: 12 },\n        front: { x: 36, y: 52, width: 4, height: 12 },\n        left: { x: 40, y: 52, width: 4, height: 12 },\n        back: { x: 44, y: 52, width: 4, height: 12 },\n        top: { x: 36, y: 48, width: 4, height: 4 },\n        bottom: { x: 40, y: 48, width: 4, height: 4 },\n      },\n      OVERLAY: {\n        right: { x: 48, y: 52, width: 4, height: 12 },\n        front: { x: 52, y: 52, width: 4, height: 12 },\n        left: { x: 56, y: 52, width: 4, height: 12 },\n        back: { x: 60, y: 52, width: 4, height: 12 },\n        top: { x: 52, y: 48, width: 4, height: 4 },\n        bottom: { x: 56, y: 48, width: 4, height: 4 },\n      },\n    },\n    SLIM: {\n      BASE: {\n        right: { x: 32, y: 52, width: 4, height: 12 },\n        front: { x: 36, y: 52, width: 3, height: 12 },\n        left: { x: 39, y: 52, width: 4, height: 12 },\n        back: { x: 43, y: 52, width: 3, height: 12 },\n        top: { x: 36, y: 48, width: 3, height: 4 },\n        bottom: { x: 39, y: 48, width: 3, height: 4 },\n      },\n      OVERLAY: {\n        right: { x: 48, y: 52, width: 4, height: 12 },\n        front: { x: 52, y: 52, width: 3, height: 12 },\n        left: { x: 55, y: 52, width: 4, height: 12 },\n        back: { x: 59, y: 52, width: 3, height: 12 },\n        top: { x: 52, y: 48, width: 3, height: 4 },\n        bottom: { x: 55, y: 48, width: 3, height: 4 },\n      },\n    },\n  } as ArmRegions,\n\n  RIGHT_LEG: {\n    BASE: {\n      right: { x: 0, y: 20, width: 4, height: 12 },\n      front: { x: 4, y: 20, width: 4, height: 12 },\n      left: { x: 8, y: 20, width: 4, height: 12 },\n      back: { x: 12, y: 20, width: 4, height: 12 },\n      top: { x: 4, y: 16, width: 4, height: 4 },\n      bottom: { x: 8, y: 16, width: 4, height: 4 },\n    },\n    OVERLAY: {\n      right: { x: 0, y: 36, width: 4, height: 12 },\n      front: { x: 4, y: 36, width: 4, height: 12 },\n      left: { x: 8, y: 36, width: 4, height: 12 },\n      back: { x: 12, y: 36, width: 4, height: 12 },\n      top: { x: 4, y: 32, width: 4, height: 4 },\n      bottom: { x: 8, y: 32, width: 4, height: 4 },\n    },\n  } as BodyPartLayerRegions,\n\n  LEFT_LEG: {\n    BASE: {\n      right: { x: 16, y: 52, width: 4, height: 12 },\n      front: { x: 20, y: 52, width: 4, height: 12 },\n      left: { x: 24, y: 52, width: 4, height: 12 },\n      back: { x: 28, y: 52, width: 4, height: 12 },\n      top: { x: 20, y: 48, width: 4, height: 4 },\n      bottom: { x: 24, y: 48, width: 4, height: 4 },\n    },\n    OVERLAY: {\n      right: { x: 0, y: 52, width: 4, height: 12 },\n      front: { x: 4, y: 52, width: 4, height: 12 },\n      left: { x: 8, y: 52, width: 4, height: 12 },\n      back: { x: 12, y: 52, width: 4, height: 12 },\n      top: { x: 4, y: 48, width: 4, height: 4 },\n      bottom: { x: 8, y: 48, width: 4, height: 4 },\n    },\n  } as BodyPartLayerRegions,\n} as const;\n\n/**\n * Model dimensions in Minecraft units (1 unit = 1 pixel on skin)\n */\nexport const MODEL_DIMENSIONS = {\n  HEAD: { width: 8, height: 8, depth: 8 },\n  TORSO: { width: 8, height: 12, depth: 4 },\n  ARM_CLASSIC: { width: 4, height: 12, depth: 4 },\n  ARM_SLIM: { width: 3, height: 12, depth: 4 },\n  LEG: { width: 4, height: 12, depth: 4 },\n} as const;\n\n/**\n * Body part positions relative to model origin (center at torso bottom)\n * Y-axis points up, origin at feet level center\n */\nexport const BODY_POSITIONS: Record<string, Vector3> = {\n  HEAD: { x: 0, y: 24, z: 0 },\n  TORSO: { x: 0, y: 18, z: 0 },\n  LEFT_ARM: { x: 6, y: 22, z: 0 },\n  RIGHT_ARM: { x: -6, y: 22, z: 0 },\n  LEFT_LEG: { x: 2, y: 6, z: 0 },\n  RIGHT_LEG: { x: -2, y: 6, z: 0 },\n};\n\n/**\n * Pivot points for rotation (relative to body part position)\n */\nexport const PIVOT_POINTS: Record<string, Vector3> = {\n  HEAD: { x: 0, y: -4, z: 0 },\n  TORSO: { x: 0, y: 0, z: 0 },\n  LEFT_ARM: { x: -2, y: 4, z: 0 },\n  RIGHT_ARM: { x: 2, y: 4, z: 0 },\n  LEFT_LEG: { x: 0, y: 6, z: 0 },\n  RIGHT_LEG: { x: 0, y: 6, z: 0 },\n};\n\n/**\n * Default view configuration\n */\nexport const DEFAULT_VIEW: ViewConfig = {\n  angle: 25,\n  elevation: 10,\n  zoom: 1.0,\n};\n\n/**\n * Default full body rendering options\n */\nexport const DEFAULT_FULLBODY_OPTIONS: Required<\n  Omit<FullBodyOptions, 'armModel' | 'pose'>\n> & { pose: 'standing' } = {\n  width: 300,\n  height: 400,\n  includeOverlay: true,\n  pose: 'standing',\n  view: DEFAULT_VIEW,\n  background: null,\n  fallbackUuid: STEVE_UUID,\n  shadow: false,\n};\n","'use client';\n\nimport { useState, useEffect, memo, useCallback } from 'react';\nimport type { MinecraftFullBodyProps, PoseName } from '../shared/types';\nimport { STEVE_UUID } from '../shared/constants';\n\nconst MinecraftFullBodyComponent = ({\n  uuid,\n  mcid,\n  width = 128,\n  height = 256,\n  pose = 'standing',\n  angle = 25,\n  className = '',\n  priority = false,\n  apiEndpoint = '/api/fullbody',\n}: MinecraftFullBodyProps) => {\n  const [imgError, setImgError] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n\n  // Construct API URL\n  const imageUrl = `${apiEndpoint}?uuid=${uuid}&width=${width}&height=${height}&pose=${pose}&angle=${angle}`;\n  const fallbackUrl = `${apiEndpoint}?uuid=${STEVE_UUID}&width=${width}&height=${height}&pose=${pose}&angle=${angle}`;\n\n  // Reset state when props change\n  useEffect(() => {\n    setImgError(false);\n    setIsLoading(true);\n  }, [uuid, pose, angle, width, height]);\n\n  const handleLoad = useCallback(() => {\n    setIsLoading(false);\n  }, []);\n\n  const handleError = useCallback(() => {\n    setImgError(true);\n    setIsLoading(false);\n  }, []);\n\n  return (\n    <div\n      className={className}\n      style={{\n        width,\n        height,\n        position: 'relative',\n      }}\n    >\n      <img\n        src={imgError ? fallbackUrl : imageUrl}\n        alt={mcid ? `${mcid} のフルボディ` : 'Minecraft full body avatar'}\n        width={width}\n        height={height}\n        style={{\n          imageRendering: 'pixelated',\n          display: isLoading ? 'none' : 'block',\n          width,\n          height,\n        }}\n        onLoad={handleLoad}\n        onError={handleError}\n        loading={priority ? 'eager' : 'lazy'}\n        decoding=\"async\"\n      />\n      {isLoading && (\n        <div\n          style={{\n            width,\n            height,\n            backgroundColor: '#3c3c3c',\n            position: 'absolute',\n            top: 0,\n            left: 0,\n          }}\n        />\n      )}\n    </div>\n  );\n};\n\n/**\n * Minecraft Full Body Avatar Component\n *\n * Displays a player's 3D full-body Minecraft avatar by fetching from the API endpoint.\n *\n * @example\n * ```tsx\n * import { MinecraftFullBody } from '@bafv4/mcavatar/react';\n *\n * <MinecraftFullBody\n *   uuid={player.uuid}\n *   mcid={player.mcid}\n *   width={128}\n *   height={256}\n *   pose=\"waving\"\n *   angle={30}\n * />\n * ```\n */\nexport const MinecraftFullBody = memo(MinecraftFullBodyComponent);\n"],"mappings":"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","names":["useState","useEffect","memo","useCallback","jsx","jsxs","useState","useEffect","useCallback","memo"]}